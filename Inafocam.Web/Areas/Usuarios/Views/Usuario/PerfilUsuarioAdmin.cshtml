
@using Andamios.Web.Helpers
@model Andamios.Web.Areas.Usuarios.Models.PerfilUsuario

@{
    MensajesViewModel mensaje = new MensajesViewModel();

    if (TempData["mensaje"] != null)
    {
        mensaje = TempData.Get<MensajesViewModel>("mensaje");

    }

    var urlImg = "default.png";

    @if (!string.IsNullOrEmpty(Model.EditarUsuarioModel.Imagen))
    {
        urlImg = Model.EditarUsuarioModel.Imagen;
    }

    var num = 1;
    var UsuarioId = Model.EditarUsuarioModel.Id;
    //var userLoggedId = User.GetUserId();
}


@section Style
{
    <!-- BEGIN: VENDOR CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/flag-icon/css/flag-icon.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/pages/data-tables.css">

    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/data-tables/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/data-tables/extensions/responsive/css/responsive.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/data-tables/css/select.dataTables.min.css">
    <!-- END: VENDOR CSS-->
    <!-- BEGIN: Page Level CSS-->
    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="~/app-assets/css/custom/custom.css">
    <!-- END: Custom CSS-->
    @*<link href="~/lib/toastr.js/toastr.css" rel="stylesheet" />*@
    @*<link href="~/lib/toastr.js/toastr.min.css" rel="stylesheet" />*@
    <link href="~/lib/jquery-confirm/dist/jquery-confirm.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="~/app-assets/vendors/dropify/css/dropify.min.css">
    <script src="~/app-assets/vendors/dropify/js/dropify.min.js"></script>

}

@* BREADCRUMB *@
@await Component.InvokeAsync("BreadcrumbComponent", new { controlador = (string)ViewData["controlador"], vista = (string)ViewData["vista"] })

@* END BREADCRUMB *@

@{
    //Model.EditarUsuarioModel.Email
}

@* RAZOR *@
<!-- Page Length Options -->
<div id="" class="row">
    <div class="card bg-opacity-9">

        <form class="register-form" asp-area="Usuarios" asp-controller="Usuario" asp-action="Editar" method="post">

            <input type="hidden" asp-for="@Model.EditarUsuarioModel.Id" />
            <input type="hidden" asp-for="@Model.EditarUsuarioModel.UserName" />
            @*<input type="hidden" asp-for="@Model.EditarUsuarioModel.Nombre" />
            <input type="hidden" asp-for="@Model.EditarUsuarioModel.Apellido" />
            <input type="hidden" asp-for="@Model.EditarUsuarioModel.Email" />*@
            <input type="hidden" asp-for="@Model.EditarUsuarioModel.Estado" />
            <input type="hidden" asp-for="@Model.EditarUsuarioModel.Imagen" />

            <div class="card-content">
                <div class="row ml-4">
                    <div class="col s12 m12 l12">
                        <div class="col s12 m9 l9 user-section-negative-margin ml-8">
                            <div class="row">
                                <div class="col s12 center-align center m-0">

                                    <img class="responsive-img circle " width="120" src="/app-assets/images/usuario/@urlImg" alt="">
                                    <div class=" col s12 ">

                                        @*<div class="col s5 "></div>
                                            <div class="col s2 center">
                                                <input type="file"
                                                       id="input-file-events"
                                                       name="imagen"
                                                       class="dropify-event"
                                                       data-height="110"
                                                       data-default-file="/app-assets/images/usuario/@urlImg"
                                                       data-max-file-size="1M" />
                                            </div>
                                            <div class="col s5"></div>*@
                                    </div>
                                    <br>
                                    <span class="center">
                                        <h5 class="teal-text lighten-2">@Model.EditarUsuarioModel.Nombre @Model.EditarUsuarioModel.Apellido  </h5>
                                        <h6 class="teal-text lighten-2">@Model.EditarUsuarioModel.UserName </h6>

                                        @if (!String.IsNullOrEmpty(Model.EditarUsuarioModel.Role))
                                        {
                                            <h6 class="grey-text lighten-2">@Model.EditarUsuarioModel.Role  </h6>

                                        }
                                        else
                                        {
                                            <h6 class="grey-text lighten-2">Rol no asignado</h6>

                                        }

                                    </span>
                                </div>

                                <div class="col s12 center-align center m-0">
                                    <a class="btn modal-trigger  waves-effect waves-light teal tooltipped" href="#contrasena" data-position="top" data-tooltip="Cambiar Contraseña">
                                        <i class="material-icons">  lock_open</i>
                                       Contraseña
                                    </a>
                                </div>

                            </div>


                            <div class="col s12 center mt-2">

                            </div>

                            <div class="col s12 m4 l4 ">
                                @*Este div esta creado para rellenar el lado de la derecha *@

                            </div>
                        </div>


                    </div>

                    <div class="row ml-4">
                        <div class="col m12 s6 l6">

                            <div class="row margin">
                                <div class="input-field col s9">
                                    <i class="material-icons prefix pt-2">face</i>
                                    <input class="validate" id="nombre" type="text" asp-for="@Model.EditarUsuarioModel.Nombre">
                                    <label for="nombre" class="center-align">Nombre</label>
                                    <span asp-validation-for="@Model.EditarUsuarioModel.Nombre" class="red-text"></span>

                                </div>
                            </div>

                            <div class="row margin">
                                <div class="input-field col s9">
                                    <i class="material-icons prefix pt-2">face</i>
                                    <input  class="validate" id="apellido" type="text" asp-for="EditarUsuarioModel.Apellido">
                                    <label for="apellido" class="center-align ">Apellido</label>
                                    <span asp-validation-for="EditarUsuarioModel.Apellido" class="red-text"></span>

                                </div>
                            </div>  
                            
                            
                            <div class="row ml-1">
                                <div class="input-field col s9 mt-">
                                    <div class="row">
                                        <label for="select2User" class="col s12">   <i class="material-icons" >school</i>Universidades</label>
                                    </div>
                                    @{ 
                                        object noUniversidad = null;
                                    }

                                    <select asp-for="EditarUsuarioModel.UniversityId"  class="form-control js-example-basic-single" style="width: 100%" asp-items="@(new SelectList(Model.Universidades,"UniversityId","UniversityName"))">
                                        <option value="" selected disabled>Seleccione una Opción</option>
                                        <option value="@noUniversidad" >Ninguna</option>
                                    </select>

                                </div>
                            </div>

                        </div>



                        <div class="col m12 s6 l6">
                            <div class="row margin">
                                <div class="input-field col s9">
                                    <i class="material-icons prefix pt-2">mail_outline</i>
                                    <input  class="validate" id="email" type="text" asp-for="@Model.EditarUsuarioModel.Email">
                                    <label for="email" class="center-align">Email</label>
                                    <span asp-validation-for="@Model.EditarUsuarioModel.Email" class="red-text"></span>

                                </div>
                            </div>

                            @*<input asp-for="EditarUsuarioModel.Role" type="hidden" />*@

                            <div class="row margin">
                                <div class="input-field col s9">
                                    <div class="row">
                                        <label for="select2User" class="col s12">   <i class="material-icons">verified_user</i>Roles</label>
                                    </div>

                                    @{ 
                                        object noRole = null;
                                    }
                                    <select asp-for="EditarUsuarioModel.Role" class="form-control js-example-basic-single" style="width: 100%" asp-items="ViewBag.Role">
                                        <option value="" selected disabled>Seleccione una Opción</option>
                                        <option value="@noRole" >Ninguno</option>
                                    </select>

                                </div>
                            </div>
                        </div>

                        <div class="col m12 s6 l6">
                            @*<div class="row margin">
                                <div class="input-field col s9">
                                    <button type="submit" class="btn waves-effect waves-light border-round teal col s12 btn-small ">
                                        <i class="material-icons dp48">save</i>
                                        Guardar Cambios
                                    </button>

                                </div>
                            </div>*@

                            <input asp-for="EditarUsuarioModel.Role" type="hidden" />

                            <div class="row margin">
                                <div class="input-field col s9">
                                    <div class="row">
                                        @*<label for="select2User" class="col s12">   <i class="material-icons">verified_user</i>Roles</label>*@
                                        <br />
                                    </div>

                                    <button type="submit" class="btn waves-effect waves-light border-round teal col s12 btn-small ">
                                        <i class="material-icons dp48">save</i>
                                        Guardar Cambios
                                    </button>
                                </div>
                            </div>
                        </div>

                    </div>


                </div>
                @*<div class="row ml-10">
                    <div class=" col s12  ml-10">

                        <div class="col  s3"></div>
                        <div class="input-field col s5 ">
                            <button type="submit" class="btn-floating btn-large teal gradient-shadow ml-10" data-tooltip="Guardar Cambios">
                                <i class="material-icons dp48">save</i>

                            </button>
                        </div>
                        <div class="col  s3"></div>

                    </div>
                </div>*@

            </div>




        </form>



        <div class="row margin">
            <div class="input-field col s9">


                <div class="modal mt-4" id="contrasena">
                    @{
                        Model.ResetPasswordViewModel.area = "PerfilUsuarioAdmin";
                        Model.ResetPasswordViewModel.controller = "Usuario";
                        Model.ResetPasswordViewModel.Url = "PerfilUsuarioAdmin";
                    }

                    @await Component.InvokeAsync("ResetPasswordComponent", Model.ResetPasswordViewModel);

                </div>

            </div>
        </div>

    </div>
</div>
@* END MODAL *@

@* END RAZOR *@

@section Scripts
{
    <!-- BEGIN VENDOR JS-->
    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="~/app-assets/vendors/jquery-validation/jquery.validate.js"></script>
    <script src="~/app-assets/vendors/jquery-validation/additional-methods.js"></script>
    <script src="~/app-assets/vendors/jquery-cookies/jquery.cookies.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>

    <!-- BEGIN VENDOR JS-->
    <script src="~/app-assets/js/vendors.min.js" type="text/javascript"></script>
    <!-- BEGIN VENDOR JS-->
    <!-- BEGIN PAGE VENDOR JS-->
    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN THEME  JS-->
    <script src="~/app-assets/js/plugins.js" type="text/javascript"></script>
    <script src="~/app-assets/js/custom/custom-script.js" type="text/javascript"></script>
    <script src="~/lib/toastr.js/toastr.min.js"></script>
    <script src="~/app-assets/js/toastr.init.js" type="text/javascript"></script>
    <script src="~/app-assets/vendors/formatter/jquery.formatter.min.js" type="text/javascript"></script>
    @*<script src="~/app-assets/js/scripts/form-elements.js"></script>*@
    <script src="~/app-assets/js/scripts/form-masks.js"></script>
    <script src="~/lib/jquery-confirm/dist/jquery-confirm.min.js"></script>
    <script src="~/app-assets/js/scripts/card-advanced.js" type="text/javascript"></script>
    @*<script src="~/app-assets/js/scripts/form-layouts.js" type="text/javascript"></script>*@
    @*<script src="~/lib/jquery/dist/jquery.js"></script>
        <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
        <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>*@
    <script src="~/app-assets/js/scripts/form-file-uploads.js"></script>
    <script src="~/app-assets/js/scripts/form-elements.js"></script>
    <script src="~/app-assets/js/scripts/form-masks.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/js/select2.min.js"></script>

    <script>

   



        if ("@mensaje.Tipo".length > 0) {
            $.confirm({
                title: '@mensaje.Titulo',
                content: '@mensaje.Texto',
                type: '@mensaje.Tipo',
                typeAnimated: true,
                boxWidth: '500px',
                autoClose: 'cerrar|5000',
                useBootstrap: false,
                buttons: {
                    cerrar:{
                        text: "Cerrar",
                        action: function () { }
                    }
                },
                onClose: function () {
                    // before the modal is hidden.
                    $.ajax({
                        type: 'get',
                        url: '/home/ClearTempData',
                        success: function() {

                        }
                    });
                }
            });
        }


        $(document).ready(function () {
            $('.modal').modal();

            $('.js-example-basic-single').select2({
                //placeholder: "Seleccione una Opción",
            });

            $('.phone').formatter({
                'pattern': '({{999}}) {{999}}-{{9999}}',
                'persistent': false
            });

            $(".validationDisplay").attr("style", "display:none");


        });

    </script>


}
